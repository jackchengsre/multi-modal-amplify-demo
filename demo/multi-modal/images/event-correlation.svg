<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="600" fill="#f8f9fa" rx="10" ry="10"/>
  
  <!-- Title -->
  <text x="400" y="40" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#0066cc">Event Correlation Process</text>
  
  <!-- Main Container -->
  <rect x="50" y="80" width="700" height="480" fill="#ffffff" stroke="#232f3e" stroke-width="2" rx="10" ry="10"/>
  
  <!-- Input Data Section -->
  <rect x="80" y="110" width="640" height="100" fill="#f0f8ff" stroke="#0066cc" stroke-width="1" rx="5" ry="5"/>
  <text x="400" y="130" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#0066cc">Input Data Sources</text>
  
  <!-- Input Data Items -->
  <rect x="100" y="150" width="140" height="40" fill="#ffffff" stroke="#0066cc" stroke-width="1" rx="3" ry="3"/>
  <text x="170" y="175" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333333">CloudTrail Events</text>
  
  <rect x="260" y="150" width="140" height="40" fill="#ffffff" stroke="#0066cc" stroke-width="1" rx="3" ry="3"/>
  <text x="330" y="175" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333333">VPC Flow Log Records</text>
  
  <rect x="420" y="150" width="140" height="40" fill="#ffffff" stroke="#0066cc" stroke-width="1" rx="3" ry="3"/>
  <text x="490" y="175" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333333">Health Dashboard Events</text>
  
  <rect x="580" y="150" width="140" height="40" fill="#ffffff" stroke="#0066cc" stroke-width="1" rx="3" ry="3"/>
  <text x="650" y="175" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333333">Trusted Advisor Checks</text>
  
  <!-- Arrows from Input to Processing -->
  <line x1="170" y1="190" x2="170" y2="230" stroke="#0066cc" stroke-width="1"/>
  <polygon points="170,230 165,220 175,220" fill="#0066cc"/>
  
  <line x1="330" y1="190" x2="330" y2="230" stroke="#0066cc" stroke-width="1"/>
  <polygon points="330,230 325,220 335,220" fill="#0066cc"/>
  
  <line x1="490" y1="190" x2="490" y2="230" stroke="#0066cc" stroke-width="1"/>
  <polygon points="490,230 485,220 495,220" fill="#0066cc"/>
  
  <line x1="650" y1="190" x2="650" y2="230" stroke="#0066cc" stroke-width="1"/>
  <polygon points="650,230 645,220 655,220" fill="#0066cc"/>
  
  <!-- Processing Section -->
  <rect x="80" y="230" width="640" height="120" fill="#f0f0ff" stroke="#5a2ca0" stroke-width="1" rx="5" ry="5"/>
  <text x="400" y="250" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#5a2ca0">Event Processing</text>
  
  <!-- Processing Steps -->
  <rect x="100" y="270" width="140" height="60" fill="#ffffff" stroke="#5a2ca0" stroke-width="1" rx="3" ry="3"/>
  <text x="170" y="290" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#5a2ca0">Normalization</text>
  <text x="170" y="310" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333333">Convert to standard format</text>
  
  <rect x="260" y="270" width="140" height="60" fill="#ffffff" stroke="#5a2ca0" stroke-width="1" rx="3" ry="3"/>
  <text x="330" y="290" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#5a2ca0">Enrichment</text>
  <text x="330" y="310" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333333">Add context information</text>
  
  <rect x="420" y="270" width="140" height="60" fill="#ffffff" stroke="#5a2ca0" stroke-width="1" rx="3" ry="3"/>
  <text x="490" y="290" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#5a2ca0">Filtering</text>
  <text x="490" y="310" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333333">Remove irrelevant events</text>
  
  <rect x="580" y="270" width="140" height="60" fill="#ffffff" stroke="#5a2ca0" stroke-width="1" rx="3" ry="3"/>
  <text x="650" y="290" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#5a2ca0">Grouping</text>
  <text x="650" y="310" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333333">Group related events</text>
  
  <!-- Processing Flow Arrows -->
  <line x1="240" y1="300" x2="260" y2="300" stroke="#5a2ca0" stroke-width="1"/>
  <polygon points="260,300 250,295 250,305" fill="#5a2ca0"/>
  
  <line x1="400" y1="300" x2="420" y2="300" stroke="#5a2ca0" stroke-width="1"/>
  <polygon points="420,300 410,295 410,305" fill="#5a2ca0"/>
  
  <line x1="560" y1="300" x2="580" y2="300" stroke="#5a2ca0" stroke-width="1"/>
  <polygon points="580,300 570,295 570,305" fill="#5a2ca0"/>
  
  <!-- Arrow from Processing to Correlation -->
  <line x1="400" y1="350" x2="400" y2="370" stroke="#5a2ca0" stroke-width="1"/>
  <polygon points="400,370 395,360 405,360" fill="#5a2ca0"/>
  
  <!-- Correlation Section -->
  <rect x="80" y="370" width="640" height="120" fill="#fff4e6" stroke="#ff9900" stroke-width="1" rx="5" ry="5"/>
  <text x="400" y="390" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#ff9900">Event Correlation</text>
  
  <!-- Correlation Steps -->
  <rect x="100" y="410" width="140" height="60" fill="#ffffff" stroke="#ff9900" stroke-width="1" rx="3" ry="3"/>
  <text x="170" y="430" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#ff9900">Temporal Analysis</text>
  <text x="170" y="450" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333333">Analyze event timing</text>
  
  <rect x="260" y="410" width="140" height="60" fill="#ffffff" stroke="#ff9900" stroke-width="1" rx="3" ry="3"/>
  <text x="330" y="430" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#ff9900">Pattern Recognition</text>
  <text x="330" y="450" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333333">Identify common patterns</text>
  
  <rect x="420" y="410" width="140" height="60" fill="#ffffff" stroke="#ff9900" stroke-width="1" rx="3" ry="3"/>
  <text x="490" y="430" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#ff9900">Relationship Analysis</text>
  <text x="490" y="450" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333333">Find event relationships</text>
  
  <rect x="580" y="410" width="140" height="60" fill="#ffffff" stroke="#ff9900" stroke-width="1" rx="3" ry="3"/>
  <text x="650" y="430" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#ff9900">Causal Chain</text>
  <text x="650" y="450" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333333">Build causal relationships</text>
  
  <!-- Correlation Flow Arrows -->
  <line x1="240" y1="440" x2="260" y2="440" stroke="#ff9900" stroke-width="1"/>
  <polygon points="260,440 250,435 250,445" fill="#ff9900"/>
  
  <line x1="400" y1="440" x2="420" y2="440" stroke="#ff9900" stroke-width="1"/>
  <polygon points="420,440 410,435 410,445" fill="#ff9900"/>
  
  <line x1="560" y1="440" x2="580" y2="440" stroke="#ff9900" stroke-width="1"/>
  <polygon points="580,440 570,435 570,445" fill="#ff9900"/>
  
  <!-- Arrow to Output -->
  <line x1="650" y1="470" x2="650" y2="510" stroke="#ff9900" stroke-width="1"/>
  <polygon points="650,510 645,500 655,500" fill="#ff9900"/>
  
  <!-- Output Section -->
  <rect x="500" y="510" width="220" height="40" fill="#f0fff0" stroke="#28a745" stroke-width="1" rx="5" ry="5"/>
  <text x="610" y="535" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#28a745">Correlated Event Chain</text>
  
  <!-- AWS Bedrock Integration -->
  <rect x="80" y="510" width="400" height="40" fill="#fff8e6" stroke="#ff9900" stroke-width="1" rx="5" ry="5"/>
  <text x="280" y="535" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#ff9900">Powered by AWS Bedrock Foundation Models</text>
</svg>
